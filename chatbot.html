<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat with Rio AI</title>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        :root {
            --pwc-orange: #D04A02;
            --pwc-yellow: #FFB600;
            --pwc-grey-15: #DEDEDE;
            --pwc-grey-55: #7D7D7D;
            --pwc-grey-90: #2D2D2D;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.6;
            background: #f5f5f5;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .chat-container {
            flex: 1;
            max-width: 1000px;
            margin: 2rem auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 24px rgba(0,0,0,0.1);
            display: flex;
            overflow: hidden;
        }

        .chat-sidebar {
            width: 280px;
            background: #fff;
            border-right: 1px solid var(--pwc-grey-15);
            padding: 1rem;
        }

        .chat-main {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .chat-header {
            padding: 1rem;
            border-bottom: 1px solid var(--pwc-grey-15);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .bot-profile {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .bot-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
        }

        .bot-info h4 {
            color: var(--pwc-grey-90);
            margin-bottom: 0.2rem;
        }

        .status {
            color: var(--pwc-grey-55);
            font-size: 0.8rem;
        }

        #chatMessages {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
        }

        .message {
            margin-bottom: 1rem;
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
        }

        .bot-message {
            background: #f5f5f5;
            padding: 1rem;
            border-radius: 0 12px 12px 12px;
            max-width: 80%;
        }

        .user-message {
            background: var(--pwc-orange);
            color: white;
            padding: 1rem;
            border-radius: 12px 0 12px 12px;
            max-width: 80%;
            margin-left: auto;
        }

        .input-group {
            padding: 1rem;
            border-top: 1px solid var(--pwc-grey-15);
            display: flex;
            gap: 1rem;
        }

        input {
            flex: 1;
            padding: 0.75rem 1rem;
            border: 2px solid var(--pwc-grey-15);
            border-radius: 8px;
            font-size: 0.9rem;
        }

        input:focus {
            outline: none;
            border-color: var(--pwc-orange);
        }

        button {
            background: var(--pwc-orange);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.3s;
        }

        button:hover {
            background: var(--pwc-yellow);
        }

        .quick-buttons {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .quick-btn {
            text-align: left;
            padding: 0.75rem;
            background: #f5f5f5;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .quick-btn:hover {
            background: var(--pwc-yellow);
            color: white;
        }

        @media (max-width: 768px) {
            .chat-container {
                margin: 0;
                border-radius: 0;
                height: 100vh;
            }

            .chat-sidebar {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <div class="chat-sidebar">
            <div class="quick-buttons">
                <button class="quick-btn" onclick="askQuestion('Can you help me with my math homework?')">Math Help</button>
                <button class="quick-btn" onclick="askQuestion('I need help with programming')">Coding Help</button>
                <button class="quick-btn" onclick="askQuestion('Can you explain this concept?')">Explain a Concept</button>
                <button class="quick-btn" onclick="askQuestion('Help me solve this problem')">Problem Solving</button>
                <button class="quick-btn" onclick="askQuestion('I need study tips')">Study Tips</button>
                <button class="quick-btn" onclick="askQuestion('Can you check my work?')">Check My Work</button>
            </div>
        </div>
        
        <div class="chat-main">
            <div class="chat-header">
                <div class="bot-profile">
                    <img src="assets/foto-akmal.jpeg" alt="Rio AI" class="bot-avatar">
                    <div class="bot-info">
                        <h4>Rio AI Assistant</h4>
                        <span class="status">Online</span>
                    </div>
                </div>
            </div>
            
            <div id="chatMessages"></div>
            
            <div class="input-group">
                <input type="text" id="userInput" placeholder="Type your message...">
                <button onclick="sendMessage()">Send</button>
            </div>
        </div>
    </div>

    <script type="module">
        // Store conversation history
        let conversationHistory = [
            {
                role: "system",
                content: `You are a helpful AI assistant that can help with homework, math, coding, and general questions. You should:

1. Provide clear, step-by-step explanations for complex problems
2. Show your work for mathematical calculations
3. Use examples to illustrate concepts
4. Maintain a friendly and encouraging tone
5. Ask clarifying questions when needed
6. Provide accurate and factual information
7. Acknowledge when you're not sure about something
8. Suggest additional resources when appropriate

For math problems:
- Show each step of the solution
- Explain the reasoning behind each step
- Use proper mathematical notation
- Verify the answer when possible

For homework help:
- Guide students to understand concepts rather than just giving answers
- Provide relevant examples
- Break down complex topics into simpler parts
- Suggest study strategies and resources

For coding questions:
- Provide well-commented code examples
- Explain the logic behind the solution
- Follow best practices
- Consider efficiency and readability

Remember to:
- Be patient and supportive
- Encourage critical thinking
- Maintain academic integrity
- Provide context for answers`
            }
        ];
        
        window.askQuestion = async function(question) {
            const input = document.getElementById('userInput');
            input.value = question;
            sendMessage();
        };

        // Initial greeting
        window.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                addMessage("Hi! I'm an AI assistant that can help you with homework, math, coding, and general questions. How can I help you today?", 'bot');
            }, 500);
        });

        window.sendMessage = async function() {
            const input = document.getElementById('userInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Add user message to UI and conversation history
            addMessage(message, 'user');
            conversationHistory.push({
                role: "user",
                content: message
            });
            
            input.value = '';
            
            try {
                // Show typing indicator
                const typingDiv = addMessage("Typing...", 'bot');
                
                const response = await fetch('/.netlify/functions/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ 
                        messages: conversationHistory 
                    })
                });
                
                const data = await response.json();
                
                // Remove typing indicator
                typingDiv.remove();
                
                // Add bot response to UI and conversation history
                addMessage(data.message, 'bot');
                conversationHistory.push({
                    role: "assistant",
                    content: data.message
                });
                
                // Limit conversation history to last 10 messages to prevent token limit issues
                if (conversationHistory.length > 12) {
                    conversationHistory = [
                        conversationHistory[0], // Keep system prompt
                        ...conversationHistory.slice(-10) // Keep last 10 messages
                    ];
                }
            } catch (error) {
                console.error('Error:', error);
                addMessage('Sorry, I encountered an error. Please try again.', 'bot');
            }
        };

        window.addMessage = function(text, type) {
            const messagesDiv = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}-message`;
            messageDiv.textContent = text;
            messagesDiv.appendChild(messageDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
            return messageDiv;
        };

        // Handle Enter key
        document.getElementById('userInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
    </script>
</body>
</html> 